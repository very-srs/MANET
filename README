State of the project

Network

   * Sets up a freshly flashed cm4/rpi4 board to join the user configured mesh network

   * Automatically assigns a non-conflicting IPv4 address in the configured CIDR range.
     The subnet can be of any size large enough to accommodate the number of mesh nodes
     + 5 reserved IPs

   * Automatically assigns an IPv6 address in the configured /64 prefix

   * Automatically turns any mesh node that gets internet access (via ethernet) into a 
     gateway node for the rest of the mesh

   * If more than one node is has internet access, nodes will select the one they have 
     the best link quality for as their gateway.

   * The default route on the nodes will update as these conditions change and their 
     original GW goes down or is surpassed in link quality

Service Migration

    Automatically choose the mesh node with the best connections to rest of the mesh to
host a mediaMTX server, and launch that service on the second IP of the CIDR range the
mesh uses. The service will migrate from one node to another, keeping the same IP, if
there is at least a 1.5x improvement in overall link quality on another mesh node

Mesh settings (SAE key, SSID, network ranges, etc) are set in a web configurator hosted
by the included docker image. A freshly flashed mesh node will pick these settings up
when configuring at first boot. Settings can be altered on an existing and running mesh
node without a re-flash by connecting it to the computer running this web server and
re-running /root/radio-setup.sh to pick up the new configs.


Next steps are:

  Network Services:
  * NTP server - This work is mostly complete, just needs testing
  * Mumble server - A voice chat server for the mesh that is elected to, and
    can migrate between, the best connected nodes in the mesh
  
  Expanded Hardware Support:
  * Add support for 802.11ah

  Non-Software work:
  * Adapt ethernet to usb for EUD support
  * Design an enclosure

------------------------------------------------------------------------------------


Overview

This is the basis for a portable, self-configuring, and resilient network node 
designed for infrastructure-free team communications. The system uses a 
B.A.T.M.A.N.-adv mesh network over dual-band Wi-Fi (802.11ax).


Key Components

I. Hardware Interfaces

Dual-Band Wi-Fi (wlan0, wlan1): Two 802.11ax interfaces (2.4/5 GHz) configured
for mesh mode provide redundant, high-performance links.  If a wireless
network card with a single interface is used, it will default to one 2.4 ghz
link without any changes being needed.

Ethernet (end0): Used for initial setup and internet gateway access.  

II. Functionality

bat0 (Mesh Interface): wlan0 and wlan1 are enslaved via a 
systemd service (batman-if-setup.sh). B.A.T.M.A.N.-adv runs on bat0,
using TQ metrics to optimize routing over the best Wi-Fi path.

br0 (Unified Bridge): bat0 is bridged into br0. 

IPv6: br0 receives its primary address via SLAAC from radvd
advertisements.

IPv4: br0 receives a routable private address assigned by the decentralized 
node-manager.sh service.  The node-manager.sh service uses alfred and Protobuf
messages to coordinate conflict-free assignment ofaddresses, avoiding DHCP or
static assignments.


Come join the discussion around this Armbian release and the standard
openMANET project at https://discord.gg/jBwVWHF9dy
